<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><%= product.name %> | Mi Tienda</title>
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>

  <header class="container header">
    <div>
      <h1>Mi Tienda</h1>
      <p class="subtitle">Detalle del producto</p>

      <a class="btn" href="/">← Volver al catálogo</a>
    </div>
  </header>

  <main class="container">
    <article class="card" style="overflow: hidden;">
      <img
        src="<%= product.image_url && product.image_url.length > 5 ? product.image_url : '/img/no-image.png' %>"
        alt="<%= product.name %>"
        loading="lazy"
        referrerpolicy="no-referrer"
        onerror="this.onerror=null; this.src='/img/no-image.png';"
        style="height: 320px; object-fit: cover;"
      />

      <div class="content">
        <div class="row">
          <strong style="font-size: 20px;"><%= product.name %></strong>
          <span class="badge"><%= product.category %></span>
        </div>

        <p class="desc" style="font-size: 15px;">
          <%= product.description %>
        </p>

        <div class="row">
          <span class="price" style="font-size: 18px;">
            Q <%= product.price %>
          </span>
          <span class="badge">ID: <%= product.id %></span>
        </div>

        <% 
          const msg = `Hola, me interesa este producto:\n- ${product.name}\n- ID: ${product.id}\n- Precio: Q ${product.price}\n¿Está disponible?`;
          const waLink = whatsappNumber 
            ? `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`
            : "";
        %>

        <div class="actions" style="margin-top: 10px;">
          <% if (waLink) { %>
            <a class="btn wa" href="<%= waLink %>" target="_blank" rel="noopener">
              Consultar por WhatsApp
            </a>
          <% } else { %>
            <p class="desc">Configura <b>WHATSAPP_NUMBER</b> para habilitar WhatsApp.</p>
          <% } %>
        </div>
      </div>
    </article>
  </main>

</body>
</html>
